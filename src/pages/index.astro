---
import Layout from "@/layouts/Layout.astro";
import CallToActionSection from "@/components/CallToActionSection.astro";
import Button from "@/components/Button.astro";
import Marquee from "@/components/Marquee.astro";
import FeatureCard from "@/components/FeatureCard.astro";
import EventCard from "@/components/EventCard.astro";
import { getCollection } from "astro:content";
import {
  Users,
  ArrowRight,
  UsersRound,
  Lightbulb,
  HeartHandshake,
  Sprout,
  Calendar,
} from "@lucide/astro";

const parseSpanishDate = (dateStr: string) => {
  const months: { [key: string]: number } = {
    enero: 0,
    febrero: 1,
    marzo: 2,
    abril: 3,
    mayo: 4,
    junio: 5,
    julio: 6,
    agosto: 7,
    septiembre: 8,
    octubre: 9,
    noviembre: 10,
    diciembre: 11,
  };

  const match = dateStr.match(/(\d+) de (\w+) de (\d+)/);
  if (match) {
    const day = parseInt(match[1]);
    const month = months[match[2].toLowerCase()];
    const year = parseInt(match[3]);
    return new Date(year, month, day);
  }
  return new Date(0);
};

const allEvents = await getCollection("events");
const upcomingEvents = allEvents
  .filter((event) => event.data.status.type === "upcoming")
  .sort((a, b) => {
    const dateA = parseSpanishDate(a.data.date);
    const dateB = parseSpanishDate(b.data.date);
    return dateA.getTime() - dateB.getTime();
  });

const gridClasses =
  upcomingEvents.length === 1
    ? "flex justify-center"
    : upcomingEvents.length === 2
      ? "grid grid-cols-1 gap-8 sm:grid-cols-2 justify-center"
      : "grid grid-cols-1 gap-8 sm:grid-cols-2 md:grid-cols-3";

const metadata = {
  title: "GDG ICA - Google Developer Group Ica",
  description: "Comunidad de Google Developer Group Ica",
  image: "",
  url: "https://gdgica.com/",
};
---

<Layout {...metadata}>
  <section class="py-10">
    <div class="container">
      <div class="flex flex-col-reverse items-center gap-10 md:flex-row">
        <div class="md:basis-1/2">
          <h2 class="text-primary mb-6 text-[2rem] font-bold lg:text-6xl">
            <span class="text-google-blue">Conecta. </span><span
              class="text-google-red"
              >Aprende.
            </span><span class="text-google-yellow">Construye. </span>
            <span class="text-google-green">Crece</span> con el GDG ICA
          </h2>
          <p class="text-secondary mb-10 text-xl font-medium">
            Somos una comunidad de jóvenes apasionados por la tecnología en ICA.
            Únete a nuestros eventos, comparte conocimiento y lleva tus
            habilidades al siguiente nivel.
          </p>
          <div class="flex flex-col gap-4 lg:flex-row">
            <Button
              variant="solid"
              href="https://gdg.community.dev/gdg-ica/"
              target="_blank"
            >
              Unete a GDG hoy
              <ArrowRight stroke-width={1.5} />
            </Button>
            <Button variant="outline" href="/eventos"> Ver eventos </Button>
          </div>
        </div>
        <div class="md:basis-1/2">
          <Marquee />
        </div>
      </div>
    </div>
  </section>
  <section class="bg-section py-20">
    <div class="container">
      <div
        class="grid grid-cols-2 place-items-center gap-10 md:flex md:justify-between"
      >
        <div>
          <p class="text-google-blue text-[2rem] font-bold">1000+</p>
          <p class="text-secondary">Miembros activos</p>
        </div>
        <div>
          <p class="text-google-red text-[2rem] font-bold">50+</p>
          <p class="text-secondary">Eventos</p>
        </div>
        <div>
          <p class="text-google-yellow text-[2rem] font-bold">25+</p>
          <p class="text-secondary">Expertos speakers</p>
        </div>
        <div>
          <p class="text-google-green text-[2rem] font-bold">10</p>
          <p class="text-secondary">Años activos</p>
        </div>
      </div>
    </div>
  </section>
  <section class="py-10 md:py-20">
    <div class="container">
      <div class="mx-auto mb-16 max-w-[500px] text-center">
        <h2 class="text-primary mb-4 text-4xl font-bold">
          ¿Por qué unirte al GDG ICA?
        </h2>
        <p class="text-secondary text-xl">
          Descubra los beneficios de ser parte de nuestra vibrante comunidad de
          desarrolladores
        </p>
      </div>
      <div class="grid grid-cols-1 gap-8 sm:grid-cols-2 lg:grid-cols-4">
        <FeatureCard className="border-t-google-blue border-t-4">
          <UsersRound
            stroke-width={1.5}
            size={48}
            class="text-google-blue mb-4"
          />
          <p class="text-primary mb-4 text-2xl font-bold">Conectar</p>
          <p class="text-secondary text-sm">
            Hacer networking con profesionales, estudiantes y otros apasionados
            por la tecnología de Ica y alrededores.
          </p>
        </FeatureCard>
        <FeatureCard className="border-t-google-red border-t-4">
          <Lightbulb
            stroke-width={1.5}
            size={48}
            class="text-google-red mb-4"
          />
          <p class="text-primary mb-4 text-2xl font-bold">Aprender</p>
          <p class="text-secondary text-sm">
            Participar en charlas técnicas, workshops y study jams sobre
            Android, Google Cloud, Web, AI/ML, Firebase, Flutter y mucho más.
          </p>
        </FeatureCard>
        <FeatureCard className="border-t-google-yellow border-t-4">
          <HeartHandshake
            stroke-width={1.5}
            size={48}
            class="text-google-yellow mb-4"
          />
          <p class="text-primary mb-4 text-2xl font-bold">Compartir</p>
          <p class="text-secondary text-sm">
            Presentar tus propios proyectos, compartir tus conocimientos y
            convertirte en un referente para otros.
          </p>
        </FeatureCard>
        <FeatureCard className="border-t-google-green border-t-4">
          <Sprout stroke-width={1.5} size={48} class="text-google-green mb-4" />
          <p class="text-primary mb-4 text-2xl font-bold">Crecer</p>
          <p class="text-secondary text-sm">
            Desarrollar tus habilidades técnicas y blandas, y dar un impulso a
            tu trayectoria profesional con el apoyo de una red activa.
          </p>
        </FeatureCard>
      </div>
    </div>
  </section>
  <section class="bg-section py-10 md:py-20">
    <div class="container">
      <div class="mx-auto mb-16 max-w-[540px] text-center">
        <h2 class="text-primary mb-4 text-4xl font-bold">Próximos eventos</h2>
        <p class="text-secondary text-xl">
          No te pierdas nuestros emocionantes próximos eventos
        </p>
      </div>
      {
        upcomingEvents.length > 0 ? (
          <div class={gridClasses}>
            {upcomingEvents.map((event) => (
              <EventCard slug={event.id} {...event.data} />
            ))}
          </div>
        ) : (
          <div class="flex justify-center">
            <article class="border-gray-custom relative max-w-md rounded-lg border bg-white">
              <div class="relative h-[192px] w-full overflow-hidden rounded-t-lg bg-gradient-to-br from-blue-50 via-purple-50 to-red-50">
                <div class="absolute inset-0 flex items-center justify-center">
                  <div class="text-center">
                    <div class="mb-3 inline-flex h-20 w-20 items-center justify-center rounded-full bg-white shadow-lg">
                      <Calendar
                        stroke-width={1.5}
                        size={40}
                        class="text-google-blue"
                      />
                    </div>
                  </div>
                </div>
              </div>
              <div class="absolute top-4 left-6">
                <div class="inline-flex items-center gap-2 rounded-full bg-blue-50 px-3 py-1">
                  <span class="relative flex h-2 w-2">
                    <span class="absolute inline-flex h-full w-full animate-ping rounded-full bg-blue-400 opacity-75" />
                    <span class="relative inline-flex h-2 w-2 rounded-full bg-blue-500" />
                  </span>
                  <span class="text-sm font-medium text-blue-700">
                    Próximamente
                  </span>
                </div>
              </div>
              <div class="p-6">
                <p class="text-primary mb-1 text-2xl font-bold">
                  Nuevos eventos muy pronto
                </p>
                <p class="text-secondary mb-6">
                  Estamos preparando experiencias increíbles para la comunidad
                </p>
                <ul class="text-secondary mb-4 flex flex-col gap-3">
                  <li class="flex items-center gap-3">
                    <Lightbulb stroke-width={1.5} size={16} color="#2463EB" />
                    Workshops y charlas técnicas
                  </li>
                  <li class="flex items-center gap-3">
                    <UsersRound stroke-width={1.5} size={16} color="#EF4444" />
                    Networking con la comunidad
                  </li>
                  <li class="flex items-center gap-3">
                    <Sprout stroke-width={1.5} size={16} color="#16A34A" />
                    Aprendizaje y crecimiento
                  </li>
                </ul>
                <p class="grid gap-2">
                  <Button
                    variant="solid"
                    href="https://gdg.community.dev/gdg-ica/"
                    target="_blank"
                  >
                    <Users stroke-width={1.5} />
                    Únete a la comunidad
                  </Button>
                  <Button variant="outline" href="/eventos">
                    Ver eventos pasados
                  </Button>
                </p>
              </div>
            </article>
          </div>
        )
      }
    </div>
  </section>
  <CallToActionSection>
    <h2 class="mb-6 text-3xl font-bold text-white md:text-4xl">
      ¿Listo para unirte a nuestra comunidad?
    </h2>
    <p class="mb-8 text-xl text-white">
      Conéctese con desarrolladores, aprenda nuevas tecnologías y construyan
      proyectos increíbles juntos.
    </p>
    <Button
      variant="white"
      href="https://gdg.community.dev/gdg-ica/"
      target="_blank"
    >
      <Users />
      Unete a GDG hoy
    </Button>
  </CallToActionSection>
</Layout>
